# –°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ PadelO‚ÇÇ

> **–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è**: 2025-01-21  
> **–°—Ç–∞—Ç—É—Å**: –¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è

## üìä –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

### ‚úÖ –ß—Ç–æ —É–∂–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1. **–°–∏—Å—Ç–µ–º–∞ audit-log** (`lib/audit-log.ts`)
   - –¢–∞–±–ª–∏—Ü–∞ `audit_logs` –≤ –ë–î
   - –§—É–Ω–∫—Ü–∏–∏ `logAction()` –∏ `getAuditLogs()`
   - –°—Ç—Ä–∞–Ω–∏—Ü–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ª–æ–≥–æ–≤ `/admin/logs`

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö –º–µ—Å—Ç–∞—Ö:**
   - ‚úÖ Login (`app/api/auth/login/route.ts`)
   - ‚úÖ Logout (`app/api/auth/logout/route.ts`)
   - ‚úÖ –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –ø–∞—Ä (`app/api/tournament/[id]/pair/move/route.ts`)
   - ‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ (`app/api/tournament/[id]/schedule/route.ts`)
   - ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞—Ä (`app/api/tournament/[id]/pair/route.ts`)

### ‚ùå –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç:
1. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∞:**
   - ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤
   - ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
   - ‚ùå –û—Ç–ø—Ä–∞–≤–∫–∞ email –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
   - ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ç—É—Ä–Ω–∏—Ä–∞
   - ‚ùå –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞–º–∏ —Ç—É—Ä–Ω–∏—Ä–∞
   - ‚ùå –°–æ–∑–¥–∞–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø —Ç—É—Ä–Ω–∏—Ä–∞
   - ‚ùå –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ –≥—Ä—É–ø–ø–∞–º

2. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
   - ‚ùå –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ç—É—Ä–Ω–∏—Ä
   - ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
   - ‚ùå –í—ã—Ö–æ–¥ –∏–∑ —Ç—É—Ä–Ω–∏—Ä–∞
   - ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è
   - ‚ùå –ò–∑–º–µ–Ω–µ–Ω–∏–µ email
   - ‚ùå –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ Vercel:**
   - ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Vercel Dashboard
   - ‚ùå –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤
   - ‚ùå –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

---

## üîß –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏–π

### –§–∞–∑–∞ 1: –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ –≤—Å–µ –≤–∞–∂–Ω—ã–µ API endpoints (2-3 —á–∞—Å–∞)

#### 1.1 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –∞–¥–º–∏–Ω–∞

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

1. **`app/api/admin/tournaments/route.ts`**
   - ‚úÖ POST (—Å–æ–∑–¥–∞–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('create', 'tournament', ...)`
   - ‚úÖ PUT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('update', 'tournament', ...)`
   - ‚úÖ DELETE (—É–¥–∞–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–∞) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('delete', 'tournament', ...)`

2. **`app/api/admin/users/route.ts`**
   - ‚úÖ POST (—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('create', 'user', ...)`
   - ‚úÖ PUT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('update', 'user', ...)`

3. **`app/api/admin/users/[id]/route.ts`**
   - ‚úÖ PUT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('update', 'user', ...)`
   - ‚úÖ DELETE (—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('delete', 'user', ...)`

4. **`app/api/admin/users/[id]/send-email/route.ts`**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `logAction('send_email', 'user', ...)` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–≥–æ email

5. **`app/api/admin/tournaments/[id]/participants/[participantId]/route.ts`**
   - ‚úÖ PUT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('update', 'tournament_registration', ...)`
   - ‚úÖ DELETE (—É–¥–∞–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–∞) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('delete', 'tournament_registration', ...)`

6. **`app/api/admin/tournaments/[id]/participants/[participantId]/send-email/route.ts`**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `logAction('send_email', 'tournament_registration', ...)`

7. **`app/api/admin/tournaments/groups/route.ts`**
   - ‚úÖ POST (—Å–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø—ã) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('create', 'tournament_group', ...)`
   - ‚úÖ PUT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('update', 'tournament_group', ...)`
   - ‚úÖ DELETE (—É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø—ã) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('delete', 'tournament_group', ...)`

8. **`app/api/admin/tournaments/distribute/route.ts`**
   - ‚úÖ POST (—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('distribute', 'tournament', ...)`

#### 1.2 –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**–§–∞–π–ª—ã –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**

1. **`app/api/tournament/register/route.ts`**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `logAction('register', 'tournament', ...)`

2. **`app/api/tournament/[id]/registrations/[registrationId]/route.ts`**
   - ‚úÖ PUT (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('update', 'tournament_registration', ...)`
   - ‚úÖ DELETE (–≤—ã—Ö–æ–¥ –∏–∑ —Ç—É—Ä–Ω–∏—Ä–∞) - –¥–æ–±–∞–≤–∏—Ç—å `logAction('leave', 'tournament', ...)`

3. **`app/api/user/change-password/route.ts`**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `logAction('change_password', 'user', ...)`

4. **`app/api/user/change-email/route.ts`**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `logAction('change_email', 'user', ...)`

5. **`app/api/user/confirm-email-change/route.ts`**
   - ‚úÖ –î–æ–±–∞–≤–∏—Ç—å `logAction('confirm_email_change', 'user', ...)`

---

### –§–∞–∑–∞ 2: –£–ª—É—á—à–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è (1-2 —á–∞—Å–∞)

#### 2.1 –°–æ–∑–¥–∞—Ç—å middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

**–§–∞–π–ª:** `middleware/audit-logger.ts` (–Ω–æ–≤—ã–π)

```typescript
import { NextRequest, NextResponse } from 'next/server';
import { logAction, getIpAddress, getUserAgent } from '@/lib/audit-log';
import { getSession } from '@/lib/users';

export async function auditLogger(
  request: NextRequest,
  response: NextResponse,
  action: string,
  entityType: string,
  entityId?: string | number,
  details?: Record<string, any>
) {
  try {
    const token = request.headers.get('authorization')?.replace('Bearer ', '') || 
                  request.cookies.get('auth_token')?.value;
    
    if (token) {
      const session = await getSession(token);
      if (session) {
        await logAction(action, entityType, {
          userId: session.userId,
          userEmail: session.email,
          userRole: session.role,
          entityId,
          details,
          ipAddress: getIpAddress(request),
          userAgent: getUserAgent(request),
        });
      }
    }
  } catch (error) {
    // –ù–µ –ø—Ä–µ—Ä—ã–≤–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ, –µ—Å–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å
    console.error('Error in audit logger:', error);
  }
}
```

#### 2.2 –£–ª—É—á—à–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é logAction

**–§–∞–π–ª:** `lib/audit-log.ts`

- ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –Ω–∞ —Å—Ç—Ä–æ–∫–µ 90 (await pool.execute)
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª–µ–µ –¥–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫
- ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è development

---

### –§–∞–∑–∞ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –Ω–∞ Vercel (30 –º–∏–Ω—É—Ç)

#### 3.1 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ Vercel Dashboard

1. **–ü–µ—Ä–µ–π—Ç–∏ –≤ Vercel Dashboard ‚Üí Project ‚Üí Settings ‚Üí Logs**
2. **–í–∫–ª—é—á–∏—Ç—å:**
   - ‚úÖ Function Logs
   - ‚úÖ Build Logs
   - ‚úÖ Runtime Logs

3. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã:**
   - ‚úÖ Email —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
   - ‚úÖ Slack/Discord –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

#### 3.2 –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

1. **Vercel Analytics:**
   - ‚úÖ –í–∫–ª—é—á–∏—Ç—å Web Vitals
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–∞—à–±–æ—Ä–¥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤:**
   - ‚úÖ –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ –≤ Vercel Dashboard
   - ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ—à–∏–±–æ–∫

---

## üìù –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

### –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –Ω–æ–≤—ã–π API endpoint:

```typescript
import { logAction, getIpAddress, getUserAgent } from '@/lib/audit-log';
import { getSession } from '@/lib/users';

export async function POST(request: NextRequest) {
  try {
    // ... –≤–∞—à–∞ –ª–æ–≥–∏–∫–∞ ...
    
    // –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –¥–µ–π—Å—Ç–≤–∏—è:
    const token = request.headers.get('authorization')?.replace('Bearer ', '');
    const session = token ? await getSession(token) : null;
    
    await logAction('action_name', 'entity_type', {
      userId: session?.userId,
      userEmail: session?.email,
      userRole: session?.role,
      entityId: result.id,
      details: { /* –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ—Ç–∞–ª–∏ */ },
      ipAddress: getIpAddress(request),
      userAgent: getUserAgent(request),
    });
    
    return NextResponse.json({ success: true });
  } catch (error) {
    // ...
  }
}
```

### –ö–∞–∫ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏:

1. **–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:**
   - –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/admin/logs`
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –¥–ª—è –ø–æ–∏—Å–∫–∞ –Ω—É–∂–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π

2. **–í Vercel Dashboard:**
   - –ü–µ—Ä–µ–π—Ç–∏ –≤ Project ‚Üí Logs
   - –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏, —Ñ—É–Ω–∫—Ü–∏–∏, —É—Ä–æ–≤–Ω—é –ª–æ–≥–∞

3. **–í –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö:**
   ```sql
   SELECT * FROM audit_logs 
   ORDER BY created_at DESC 
   LIMIT 100;
   ```

---

## üö® –í–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –¥–µ–π—Å—Ç–≤–∏—è (–¥–æ–ª–∂–Ω—ã –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤—Å–µ–≥–¥–∞):
- ‚úÖ Login / Logout
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ —Ç—É—Ä–Ω–∏—Ä–æ–≤
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –û—Ç–ø—Ä–∞–≤–∫–∞ email –∏–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ç—É—Ä–Ω–∏—Ä–∞

### –í–∞–∂–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å):
- ‚úÖ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–∞ —Ç—É—Ä–Ω–∏—Ä
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- ‚úÖ –í—ã—Ö–æ–¥ –∏–∑ —Ç—É—Ä–Ω–∏—Ä–∞
- ‚úÖ –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–∞—Ä–æ–ª—è/email
- ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –≥—Ä—É–ø–ø
- ‚úÖ –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤

---

## üìä –ú–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:
- –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ API endpoints
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–µ–∫—É–Ω–¥—É
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
- –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î

### –û—à–∏–±–∫–∏:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ 500
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ 404
- –û—à–∏–±–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
- –û—à–∏–±–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏ email

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å:
- –ü–æ–ø—ã—Ç–∫–∏ –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- –ü–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–∞–±–ª–∏—Ü—É –≤ –ë–î:**
   ```sql
   SELECT COUNT(*) FROM audit_logs;
   ```

2. **–í—ã–ø–æ–ª–Ω–∏—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É)**
3. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∑–∞–ø–∏—Å—å –ø–æ—è–≤–∏–ª–∞—Å—å:**
   ```sql
   SELECT * FROM audit_logs 
   WHERE action = 'login' 
   ORDER BY created_at DESC 
   LIMIT 1;
   ```

4. **–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏:**
   - –ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ `/admin/logs`
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

---

## üìÖ –ü–ª–∞–Ω –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ - –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ–≥–æ–¥–Ω—è):
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –æ—à–∏–±–∫—É –≤ `lib/audit-log.ts` (—Å—Ç—Ä–æ–∫–∞ 90)
2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `app/api/admin/tournaments/route.ts`
3. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `app/api/admin/users/route.ts`
4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ `app/api/admin/users/[id]/route.ts`
5. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–∫–∏ email

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (–í–∞–∂–Ω–æ - –≤—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ):
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. ‚úÖ –£–ª—É—á—à–∏—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `logAction`
3. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –Ω–∞ Vercel

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ):
1. ‚úÖ –°–æ–∑–¥–∞—Ç—å middleware –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
2. ‚úÖ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã
3. ‚úÖ –°–æ–∑–¥–∞—Ç—å –¥–∞—à–±–æ—Ä–¥ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏

---

*–î–æ–∫—É–º–µ–Ω—Ç —Å–æ–∑–¥–∞–Ω: 2025-01-21*  
*–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ: 2025-01-21*

